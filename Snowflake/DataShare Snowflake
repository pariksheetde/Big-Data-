USE ROLE ACCOUNTADMIN;
USE DATABASE SALES;
USE SCHEMA SALES;
SELECT * FROM SALES.movies;


--CREATE SHARE and GRANT necessary privileges to newly share created
CREATE SHARE share_movies_tb;
GRANT USAGE ON DATABASE SALES TO SHARE share_movies_tb;
GRANT USAGE ON SCHEMA SALES TO SHARE share_movies_tb;
GRANT SELECT,UPDATE ON TABLE SALES.SALES.movies TO SHARE share_movies_tb;

SHOW GRANTS TO SHARE share_movies_tb;
USE ROLE ACCOUNTADMIN;
ALTER SHARE share_movies_tb ADD ACCOUNT = pja86755;

SHOW SHARES;

--LOGIN TO NEW SNOWFLAKE ACCOUNT
CREATE OR REPLACE DATABASE movies FROM SHARE aia25189.share_movies_tb;
