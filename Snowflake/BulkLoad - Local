------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

                                                          DATA LOAD FROM LOCAL
------------------------------------------------CREATE DATABASE, SCHEMA, GRANT PRIVILEGES TO DATABASE.SCHEMA------------------------------------------------------------------------------

CREATE DATABASE rpt;
CREATE SCHEMA rpt.hr;
grant usage on database rpt to role sysadmin;
grant usage on database rpt to role accountadmin;
grant usage, create file format, create stage, create table on schema rpt.hr to role sysadmin;
grant usage, create file format, create stage, create table on schema rpt.hr to role  accountadmin;


------------------------------------------------------------------------------TABLE IS LOCATIONS------------------------------------------------------------------------------
CREATE FILE FORMAT csv_file_fmt TYPE = "CSV" FIELD_DELIMITER= ','SKIP_HEADER = 1;
CREATE OR REPLACE STAGE loc_stg  FILE_FORMAT = csv_file_fmt;
put file://C:\Users\pariksheet.d\Documents\DataSet\locations.csv @loc_stg;
list @loc_stg;

COPY INTO locations
FROM @loc_stg
-- pattern = '.*.csv'
file_format = (type = csv)
on_error = 'continue';

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------TABLE IS DEPARTMENTS------------------------------------------------------------------------------
CREATE FILE FORMAT csv_file_fmt TYPE = "CSV" FIELD_DELIMITER= ','SKIP_HEADER = 1;
CREATE OR REPLACE STAGE dept_stg FILE_FORMAT = csv_file_fmt;
put file://C:\Users\pariksheet.d\Documents\DataSet\departments.csv @dept_stg;
list @dept_stg;

COPY INTO departments
FROM @dept_stg
-- pattern = '.*.csv'
file_format = (type = csv)
on_error = 'continue';

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------TABLE IS EMPLOYEES------------------------------------------------------------------------------

CREATE OR REPLACE TABLE employees
(
employee_id int not null,
f_name varchar(30),
l_name varchar(30),
manager_id int,
department_id int,
salary number(12,2)
)
cluster by (department_id);

CREATE FILE FORMAT csv_file_fmt TYPE = "CSV" FIELD_DELIMITER= ','SKIP_HEADER = 1;
CREATE OR REPLACE STAGE emp_stg FILE_FORMAT = csv_file_fmt;
put file://C:\Users\pariksheet.d\Documents\DataSet\employees.csv @dept_stg;
list @emp_stg;

COPY INTO Employees
FROM @emp_stg
file_format = (type = csv)
on_error = 'continue';

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
