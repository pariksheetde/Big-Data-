package Bank

//import Bank.HelloWorld.spark
import org.apache.spark.sql.SparkSession
import org.apache.spark.SparkContext
import org.apache.spark.SparkConf
import org.apache.spark.sql.SQLContext
//import org.apache.spark.sql.SQLContext.implicits._
import org.apache.spark.sql.functions.count

object Churn_Model_1 extends App {
  println("Churn Modeling")

  val sparkAppConfig = new SparkConf()

  sparkAppConfig.set("spark.app.name", "churn_model_agg_10")
  sparkAppConfig.set("spark.master", "local[3]")

  val spark = SparkSession.builder.config(sparkAppConfig).getOrCreate()
  //  read the datafile from the location
  //  val sqlContext = new org.apache.spark.sql.SQLContext(sc)
  val churn = spark.read.option("inferSchema", "true").option("header", "true").csv("D:/Code/DataSet/SparkDataSet/ChurnModeling.csv")
  churn.show(10, truncate = false)

  //  select the required columns
  val  churn_agg = churn.select("CustomerId", "Surname", "CreditScore",
    "Geography", "Gender", "Age", "Tenure")
    .filter("Geography == 'France'")
    .filter("CreditScore >= 501")
    .where("Gender == 'Male'" )
    .drop("Tenure")
    .show(10, truncate = false)
  //  println(churn_agg.count())
  spark.stop()
}
